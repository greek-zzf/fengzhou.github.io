

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/logo.png">
  <link rel="icon" href="/img/logo.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="Greek">
  <meta name="keywords" content="">
  
    <meta name="description" content="当项目需要被其他项目引用时，使用 mvn clean install 安装到本地仓库，其他项目就可以引用该项目。 我们打包的默认 jar 包不能直接运行的，因为带有 main 方法的信息类不会添加到 mainfest 中（ jar 文件中 META-INF&#x2F;MANIFEST.MF 文件，没有 Main-Class一行）。为了生成可执行的 jar 文件，需要借助 maven-shade-p">
<meta property="og:type" content="article">
<meta property="og:title" content="《Maven 实战》笔记">
<meta property="og:url" content="http://wszzf.top/2021/08/20/%E3%80%8AMaven%20%E5%AE%9E%E6%88%98%E3%80%8B/index.html">
<meta property="og:site_name" content="我系渣渣丰的博客">
<meta property="og:description" content="当项目需要被其他项目引用时，使用 mvn clean install 安装到本地仓库，其他项目就可以引用该项目。 我们打包的默认 jar 包不能直接运行的，因为带有 main 方法的信息类不会添加到 mainfest 中（ jar 文件中 META-INF&#x2F;MANIFEST.MF 文件，没有 Main-Class一行）。为了生成可执行的 jar 文件，需要借助 maven-shade-p">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2021-08-20T16:40:00.000Z">
<meta property="article:modified_time" content="2024-08-30T09:27:23.957Z">
<meta property="article:author" content="Greek">
<meta property="article:tag" content="Maven">
<meta name="twitter:card" content="summary_large_image">
  
  
  
  <title>《Maven 实战》笔记 - 我系渣渣丰的博客</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"wszzf.top","root":"/","version":"1.9.3","typing":{"enable":false,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"follow_dnt":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  

  

  

  

  

  

  

  



  
<meta name="generator" content="Hexo 6.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>我系渣渣丰</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle">《Maven 实战》笔记</span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2021-08-20 16:40" pubdate>
          2021年8月20日 下午
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          15k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          121 分钟
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">《Maven 实战》笔记</h1>
            
            
              <div class="markdown-body">
                
                <p>当项目需要被其他项目引用时，使用 <code>mvn clean install</code> 安装到本地仓库，其他项目就可以引用该项目。</p>
<p>我们打包的默认 jar 包不能直接运行的，因为带有 main 方法的信息类不会添加到 mainfest 中（ jar 文件中 META-INF&#x2F;MANIFEST.MF 文件，没有 <code>Main-Class</code>一行）。为了生成可执行的 jar 文件，需要借助 <code>maven-shade-plugin</code>，配置该插件。</p>
<h2 id="使用-Maven-命令快速创建一个-maven-项目"><a href="#使用-Maven-命令快速创建一个-maven-项目" class="headerlink" title="使用 Maven 命令快速创建一个 maven 项目"></a>使用 Maven 命令快速创建一个 maven 项目</h2><p>使用命令 <code>mvn archetype:generate</code> 根据提示选择需要的骨架，输入 groupId，artifactId，version 等信息，创建项目。需要注意的是：maven2 中使用上面的命令，会去下载最新的版本，而不是稳定的版本，可能导致运行失败。maven3 则默认是下载稳定的版本。</p>
<h2 id="坐标"><a href="#坐标" class="headerlink" title="坐标"></a>坐标</h2><ul>
<li><strong>groupId：命名通常为域名反向一一对应。</strong>比如 <code>google.com</code> 可以命名为 <code>com.google</code>。</li>
<li><strong>artifactId：</strong>命名推荐的做法是<strong>使用实际的项目名称作为 artifactId 的前缀</strong>。比如项目名是 <code>demo</code>，下面有个 <code>hello</code> 模块，就可以命名为 <code>demo-hello</code>。 </li>
<li><strong>version：</strong>定义当前项目的版本信息。</li>
<li><strong>packaging：定义元素打包方式，打包方式通常与所生成的构件文件扩展名对应</strong>。例如指定为 <code>jar</code> 则构件的文件扩展名为 .jar，war 也如此。<strong>不定义 packaging 时，默认打包为 jar</strong>。打包方式会影响到构建的生命周期，比如 jar 和 war 打包会使用不同的命令。</li>
<li><strong>classifier：定义构建输出的一些附属构建。例如项目打包生成 demo.jar 文件，打包过程中可能还需要 javadoc 文件，就可以配置对应的插件来生成 javadoc 文件。</strong></li>
</ul>
<h2 id="依赖的配置"><a href="#依赖的配置" class="headerlink" title="依赖的配置"></a>依赖的配置</h2><ul>
<li><strong>type：</strong>依赖的类型，对应于项目坐标定义的 packaging。大部分情况下，该元素不必声明，默认为 jar。</li>
<li><strong>scope：</strong>依赖的作用范围。</li>
<li><strong>optional：</strong>标记依赖是否可选。</li>
<li><strong>exclusions：</strong>用来排除传递性依赖。</li>
</ul>
<h2 id="依赖的范围"><a href="#依赖的范围" class="headerlink" title="依赖的范围"></a>依赖的范围</h2><p>前置知识：Maven 编译项目主代码的时候使用一套 classpath，在编译执行测试的时候使用另一套 classpath，而实际运行 Maven 项目时候又会使用一套 classpath，因此总共有三套 classpath。</p>
<p><strong>依赖范围就是来控制与这三种 classath（编译 classpath，测试 classpath，运行 classpath）的关系</strong>。如果没有指定依赖范围，就会默认使用 <code>compile</code>依赖范围。</p>
<p><strong>依赖范围与 classpath 关系</strong></p>
<p>| <strong>依赖范围</strong></p>
<table>
<thead>
<tr>
<th><strong>（Scope）</strong></th>
<th><strong>对于编译 classpath 有效</strong></th>
<th><strong>对于测试 classpath有效</strong></th>
<th><strong>对于运行时 classpath 有效</strong></th>
<th><strong>例子</strong></th>
</tr>
</thead>
<tbody><tr>
<td>compile</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>spring-core</td>
</tr>
<tr>
<td>test</td>
<td>–</td>
<td>Y</td>
<td>–</td>
<td>JUnit</td>
</tr>
<tr>
<td>provided</td>
<td>Y</td>
<td>Y</td>
<td>–</td>
<td>servlet-api</td>
</tr>
<tr>
<td>runtime</td>
<td>–</td>
<td>Y</td>
<td>Y</td>
<td>JDBC 驱动实现</td>
</tr>
<tr>
<td>system</td>
<td>Y</td>
<td>Y</td>
<td>–</td>
<td>本地的 maven 仓库外的类库文件</td>
</tr>
</tbody></table>
<h2 id="传递性依赖和依赖范围"><a href="#传递性依赖和依赖范围" class="headerlink" title="传递性依赖和依赖范围"></a>传递性依赖和依赖范围</h2><p>传递性依赖：A –&gt; B –&gt; C，假设 A 依赖 B，B 依赖 C。称 A 对于 B 是<strong>第一直接依赖，</strong>B 对于 C 是<strong>第二直接依赖，</strong>A 对于 C 是<strong>传递性依赖。</strong></p>
<p>上面说了依赖范围不仅与三种 classpath 有关系，还对传递性依赖产生影响。如下表格所示，最左边的一行表示第一依赖范围，最上面一行表示第二直接依赖范围。</p>
<p><strong>依赖范围影响传递性依赖</strong></p>
<table>
<thead>
<tr>
<th></th>
<th>compile</th>
<th>test</th>
<th>provided</th>
<th>runtime</th>
</tr>
</thead>
<tbody><tr>
<td>compile</td>
<td>compile</td>
<td>–</td>
<td>–</td>
<td>runtime</td>
</tr>
<tr>
<td>test</td>
<td>test</td>
<td>–</td>
<td>–</td>
<td>test</td>
</tr>
<tr>
<td>provided</td>
<td>provided</td>
<td>–</td>
<td>provided</td>
<td>provided</td>
</tr>
<tr>
<td>runtime</td>
<td>runtime</td>
<td>–</td>
<td>–</td>
<td>runtime</td>
</tr>
</tbody></table>
<p>助记规律：</p>
<ul>
<li>当第二直接依赖范围是 <code>compile</code> 时，传递性依赖范围与第一直接依赖范围一致。</li>
<li>当第二直接依赖范围是 <code>test</code> 时，依赖不会得以传递。</li>
<li>当第二直接依赖范围是 <code>provided</code> 时，只传递第一依赖范围也为 <code>provided</code>的依赖。</li>
<li>当第二直接依赖范围是 <code>runtime</code> 时，传递性依赖范围与第一直接依赖范围一致，但 <code>compile</code> 除外，此时传递性依赖范围为 <code>runtime</code>。</li>
</ul>
<p><strong>依赖调节</strong></p>
<p>就近原则：A –&gt; B –&gt; C(1.0），A –&gt; B –&gt; D –&gt; C(2.0)，前者的路径长度为2，后者为3，因此 C(1.0) 被解析使用。</p>
<p>先声明先使用：遇到长度一样的，无法使用就近原则，就根据声明顺序，先声明的先解析使用。</p>
<h2 id="可选依赖"><a href="#可选依赖" class="headerlink" title="可选依赖"></a>可选依赖</h2><p>假设 A 依赖 B，B 依赖 X 和 Y，B 对于 X 和 Y 的依赖是可选依赖。A –&gt; B，B –&gt; X（可选），B –&gt; Y（可选），可选依赖不会得到传递，换句话说选择 X 或者 Y，对于 A 都不会有任何影响。</p>
<p>可选依赖在 <code>dependency</code>标签中需要添加 <code>&lt;optional&gt;true&lt;/optional&gt;</code>用来标记为可选依赖，因此 B 需要添加 X 和 Y 的依赖，并且分别在 <code>dependency</code>标签加上 <code>&lt;optional&gt;true&lt;/optional&gt;</code>。</p>
<p>当需要指定所使用的依赖时，需要在外层声明需要使用的依赖，上面的例子就需要在 A 中引入 X 或者 Y 的依赖。在理想的情况下，尽量避免可选依赖的使用。</p>
<h2 id="远程仓库认证"><a href="#远程仓库认证" class="headerlink" title="远程仓库认证"></a>远程仓库认证</h2><p>当我们使用 <code>&lt;repository&gt;&lt;/repository&gt;</code> 配置好一个远程仓库后，大部分情况下无需认证就可以直接访问，但是处于安全考虑，我们需要提供一些认证信息才能访问。此时，我们就需要配置认证信息，一般在 <code>setting.xml</code> 文件中配置，如下：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">setting</span>&gt;</span><br>  ...<br>  <span class="hljs-tag">&lt;<span class="hljs-name">server</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">id</span>&gt;</span>remoteRepository<span class="hljs-tag">&lt;/<span class="hljs-name">id</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">username</span>&gt;</span>admin<span class="hljs-tag">&lt;/<span class="hljs-name">username</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">password</span>&gt;</span>admin<span class="hljs-tag">&lt;/<span class="hljs-name">password</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">server</span>&gt;</span><br>  ...<br><span class="hljs-tag">&lt;/<span class="hljs-name">setting</span>&gt;</span><br></code></pre></td></tr></table></figure>
<p>文件中配置了认证信息，账号密码都是 <code>admin</code>，需要注意的是 <strong>id 的值要与配置的远程仓库的 id 一致。</strong></p>
<h2 id="部署至远程仓库"><a href="#部署至远程仓库" class="headerlink" title="部署至远程仓库"></a>部署至远程仓库</h2><p>编写项目的 <code>pom.xml</code> 文件，配置 distributionManagement 元素，代码如下：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">project</span>&gt;</span><br>  ...<br>  <span class="hljs-tag">&lt;<span class="hljs-name">distributionManagement</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">repository</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">id</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">id</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">url</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">url</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">repository</span>&gt;</span><br>    <br>    <span class="hljs-tag">&lt;<span class="hljs-name">snapshotRepository</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">id</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">id</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">url</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">url</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">snapshotRepository</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">distributionManagement</span>&gt;</span><br>  ...<br><span class="hljs-tag">&lt;/<span class="hljs-name">project</span>&gt;</span><br></code></pre></td></tr></table></figure>
<p>其中 distributionManagement 包含两个子元素，前者表示<strong>发布版本</strong>构件的仓库，后者表示<strong>快照版本</strong>的仓库。两个元素都需要配置 id，name，url，id 为远程仓库的唯一标识，name 为了方便阅读（取名），url 远程仓库地址。</p>
<p>发布到远程仓库的时候，往往需要认证，认证步骤与<a href="#G7puJ">远程仓库认证</a>一致。之后使用命令 <code>mvn clean deploy</code> maven 就会把项目构建输出到对应的远程仓库。</p>
<h2 id="镜像"><a href="#镜像" class="headerlink" title="镜像"></a>镜像</h2><p><strong>如果仓库 X 可以提供仓库 Y 存储的所有内容，那么就可以认为 X 是 Y 的一个镜像。</strong>换句话说，任何一个从 Y 仓库获取的构件，都可以从它的镜像中获取。由于地理原因，国内访问 maven 中央仓库很慢，因此就需要配置一个镜像，通常使用阿里云的镜像居多。配置文件如下：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">mirror</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">id</span>&gt;</span>aliyunmaven<span class="hljs-tag">&lt;/<span class="hljs-name">id</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">mirrorOf</span>&gt;</span>central<span class="hljs-tag">&lt;/<span class="hljs-name">mirrorOf</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>阿里云公共仓库<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">url</span>&gt;</span>https://maven.aliyun.com/repository/public<span class="hljs-tag">&lt;/<span class="hljs-name">url</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">mirror</span>&gt;</span><br></code></pre></td></tr></table></figure>
<p>改配置文件中 <code>&lt;mirrOf&gt;</code> 的值为 central，表示任何访问该仓库的请求都会转到这个镜像中。如果镜像需要认证，也可以基于这个 <code>&lt;id&gt;</code> aliyunmaven，配置仓库认证。</p>
<p>Maven 的 <code>&lt;mirrOf&gt;</code> 标签还支持一些更<strong>高级的配置</strong>：</p>
<ul>
<li><code>&lt;mirrorOf&gt;*&lt;/mirrorOf&gt;</code>匹配所有远程仓库</li>
<li><code>&lt;mirrorOf&gt;external: *&lt;/mirrorOf&gt;</code>匹配所有不在本机上的远程仓库<strong>。</strong></li>
<li><code>&lt;mirrorOf&gt;repo1,repo2&lt;/mirrorOf&gt;</code>匹配仓库 rpeo1，repo2，使用逗号分隔多个远程仓库。</li>
<li><code>&lt;mirrorOf&gt;*,！repo1&lt;/mirrorOf&gt;</code>匹配所有远程仓库，repo1除外。</li>
</ul>
<h2 id="生命周期"><a href="#生命周期" class="headerlink" title="生命周期"></a>生命周期</h2><p>maven 的生命周期其实就是软件从初始化到发布上线经历的一系列过程。maven 将这个过程抽象化了，每个周期所执行的操作都是交给插件完成。</p>
<p>maven 拥有三套相互独立的生命周期，分别是 <strong>clean，default，site。</strong>clean 负责清理项目，default 负责构建项目，site 负责建立项目站点。</p>
<p>每个生命周期都包含一些阶段（phase），这些阶段都是有顺序的，并且后面的阶段依赖于前面的阶段。比如 clean 生命周期包含: <code>pre-clean</code>，<code>clean</code>，<code>post-clean</code> 阶段，当用户调用 pre-clean，只有 pre-clean 阶段会执行，当调用 post-clean 时，pre-clean，clean，post-clean 都会执行。<strong>由于三个生命周期互不影响，当调用某个生命周期的某个阶段时，对其他的生命周期没有任何影响。</strong></p>
<h3 id="clean-生命周期阶段"><a href="#clean-生命周期阶段" class="headerlink" title="clean 生命周期阶段"></a>clean 生命周期阶段</h3><ul>
<li>pre-clean 执行清理前需要完成的工作</li>
<li>clean 清理上一次构建生成的文件</li>
<li>post-clean 执行清理后需要完成的工作</li>
</ul>
<h3 id="default-生命周期阶段（主要）"><a href="#default-生命周期阶段（主要）" class="headerlink" title="default 生命周期阶段（主要）"></a>default 生命周期阶段（主要）</h3><ul>
<li>validate 验证项目是否正确并且所有必要的信息都可用</li>
<li>compile 编译项目的源代码</li>
<li>test 使用合适的单元测试框架测试编译的源代码。这些测试不应该要求打包或部署代码</li>
<li>package 将编译后的代码打包成可分发的格式，例如 JAR。</li>
<li>verify 对集成测试的结果进行任何检查，以确保满足质量标准</li>
<li>install 将包安装到本地存储库中，作为本地其他项目的依赖项</li>
<li>deploy 在构建环境中完成，将最终包复制到远程存储库以与其他开发人员和项目共享。</li>
</ul>
<h3 id="site-生命周期阶段"><a href="#site-生命周期阶段" class="headerlink" title="site 生命周期阶段"></a>site 生命周期阶段</h3><ul>
<li>pre-site 执行生成项目站点前需要完成的工作</li>
<li>site 生成项目站点文档</li>
<li>post-site 执行生成项目站点后需要完成的工作</li>
<li>site-deploy 将生成的项目站点发布到服务器上</li>
</ul>
<h3 id="命令行与生命周期"><a href="#命令行与生命周期" class="headerlink" title="命令行与生命周期"></a>命令行与生命周期</h3><p>一些常见的 Maven 命令，解释其执行生命周期：</p>
<ul>
<li><code>mvn clean</code> 调用 clean 生命周期的 clean 阶段，即执行 <code>pre-clean</code> 和 <code>clean</code>阶段。</li>
<li><code>mvn test</code> 调用 default 生命周期的 test 阶段，即执行 <code>validate</code>、<code>compile</code>、<code>test</code> 阶段。</li>
<li><code>mvn clean install</code> 调用 clean 生命周期的 clean 阶段，以及 default 生命周期的 install 阶段。即执行 <code>pre-clean</code>和 <code>clean</code>阶段，以及 <code>validate</code>到 <code>install</code>的所有阶段。</li>
<li><code>mvn clean deploy site-deploy</code> 调用 clean 生命周期的 clean 阶段，default 生命周期的 deploy 阶段，以及 site 生命周期的 site-deploy 阶段，实际执行过程按照上面类推。</li>
</ul>
<h2 id="插件目标和插件绑定"><a href="#插件目标和插件绑定" class="headerlink" title="插件目标和插件绑定"></a>插件目标和插件绑定</h2><h3 id="插件目标"><a href="#插件目标" class="headerlink" title="插件目标"></a>插件目标</h3><p>一个插件往往能执行多个任务，因此插件具有多个功能，插件的每个功能就是一个**插件目标 (goal)**。</p>
<p><code>maven-dependency-plugin</code>就有十多个目标，每个目标对应一个功能。例如：<code>dependency:list</code>、<code>dependency:tree</code>分别是不同的功能，这是一种通用的写法，冒号前面是插件前缀，冒号后面是该插件的目标。类似的，<code>compiler:compile</code>（这是 maven-compiler-plugin 的 compile 目标）和 surefire:test（这是 maven-surefire-plugin 的 test 目标）。</p>
<h3 id="插件绑定"><a href="#插件绑定" class="headerlink" title="插件绑定"></a>插件绑定</h3><p>maven 的生命周期与插件相互绑定，具体而言就是生命周期的阶段与插件的目标相互绑定。例如 <code>mvn compile</code>就是 default 生命周期 compile 阶段与 <code>maven-compiler-plugin</code> 插件的 <code>compile</code>目标绑定。</p>
<p><strong>内置绑定</strong></p>
<p>为了简化配置，maven 为一些核心的生命周期阶段绑定了很多插件的目标。当用户调用对于的生命周期阶段时，绑定的插件目标就会执行相应的任务。</p>
<p>例如：clean 生命周期的 clean 阶段，就绑定了 <code>maven-clean-plugin</code>插件的 <code>clean</code> 目标绑定。site 生命周期的 site 阶段绑定 <code>maven-site-plugin</code> 插件的 <code>site</code> 目标，site-deploy 阶段绑定到 <code>maven-site-pugin</code>插件的 <code>deploy</code>目标。</p>
<p>由于项目的打包类型会影响构建的具体过程，因此 default 的生命周期阶段与插件的目标绑定关系与打包类型有关系。<br>default 生命周期的内置插件绑定关系（打包类型为 jar）</p>
<table>
<thead>
<tr>
<th>生命周期阶段</th>
<th>插件目标</th>
<th>执行任务</th>
</tr>
</thead>
<tbody><tr>
<td>process-resources</td>
<td>maven-resources-plugin:resources</td>
<td>复制主资源文件至输出目录</td>
</tr>
<tr>
<td>compile</td>
<td>maven-compiler-plugin:compile</td>
<td>编译主代码至输出目录</td>
</tr>
<tr>
<td>process-test-resources</td>
<td>maven-resources-plugin:testResources</td>
<td>复制测试资源文件至测试输出目录</td>
</tr>
<tr>
<td>test-compile</td>
<td>maven-compiler-plugin:testCompile</td>
<td>编译测试代码至测试输出目录</td>
</tr>
<tr>
<td>test</td>
<td>maven-surefire-plugin:test</td>
<td>执行测试用例</td>
</tr>
<tr>
<td>package</td>
<td>maven-jar-plugin:jar</td>
<td>创建项目 jar 包</td>
</tr>
<tr>
<td>install</td>
<td>maven-install-plugin:install</td>
<td>将项目构建输出到本地仓库</td>
</tr>
<tr>
<td>deploy</td>
<td>maven-deploy-plugin:deploy</td>
<td>将项目构建输出到远程仓库</td>
</tr>
</tbody></table>
<p>上面只是列举了 default 生命周期绑定了插件的阶段，并非 default 的所有阶段。</p>
<p><strong>自定义绑定</strong></p>
<p>除了上面的内置绑定外，插件还支持自定义绑定，拿 <code>maven-compiler-plugin</code>插件举例</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs xml"><br> <span class="hljs-tag">&lt;<span class="hljs-name">plugins</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">plugin</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>maven-compiler-plugin<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.1<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>               	 <span class="hljs-tag">&lt;<span class="hljs-name">executions</span>&gt;</span><br>                    <span class="hljs-tag">&lt;<span class="hljs-name">execution</span>&gt;</span><br>                        <span class="hljs-tag">&lt;<span class="hljs-name">id</span>&gt;</span>diy-compile<span class="hljs-tag">&lt;/<span class="hljs-name">id</span>&gt;</span><br>                        <span class="hljs-tag">&lt;<span class="hljs-name">phase</span>&gt;</span>verify<span class="hljs-tag">&lt;/<span class="hljs-name">phase</span>&gt;</span><br>                        <span class="hljs-tag">&lt;<span class="hljs-name">goals</span>&gt;</span><br>                            <span class="hljs-tag">&lt;<span class="hljs-name">goal</span>&gt;</span>testCompile<span class="hljs-tag">&lt;/<span class="hljs-name">goal</span>&gt;</span><br>                        <span class="hljs-tag">&lt;/<span class="hljs-name">goals</span>&gt;</span><br>                    <span class="hljs-tag">&lt;/<span class="hljs-name">execution</span>&gt;</span><br>                <span class="hljs-tag">&lt;/<span class="hljs-name">executions</span>&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">plugin</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">plugins</span>&gt;</span><br><br></code></pre></td></tr></table></figure>
<p>上面代码将 <code>maven-compiler-plugin</code>插件的 <code>testCompile</code>目标绑定到 default 上面周期的 verify 阶段。当运行 mvn verify 时，该插件的 testCompile 目标就会执行。phase 表示绑定的声明周期阶段，因为插件可以在一个生命周期阶段运行多个方法，所以可以配置多个目标，即多个 goal。</p>
<p>有的时候，没有使用 phase，插件目标目标也能绑定到声明周期的阶段中去。这是因为很多插件在目标的编写时候已经定义好了默认绑定的阶段。可以使用命令查看 <code>mvn help:describe -Dplugin=compiler  -Ddetail</code> 查看插件的详细信息，默认绑定的阶段等。</p>
<p><strong>当一个阶段有多个插件目标绑定时，执行顺序与插件的声明顺序有关，先声明先执行</strong>。</p>
<h2 id="插件配置"><a href="#插件配置" class="headerlink" title="插件配置"></a>插件配置</h2><p>插件目标像 Java 中的函数一样，执行相应的功能，并且还有参数，这些参数的具体值，我们可以配置，传递给插件目标。</p>
<h3 id="命令行插件配置"><a href="#命令行插件配置" class="headerlink" title="命令行插件配置"></a>命令行插件配置</h3><p>命令行插件配置算是比较经典的配置手段了，在 Java 中可以使用 <code>-D</code> 参数配置系统属性。Maven 简单的重用了该参数，在检查插件的时候检查系统属性，实现了插件参数的配置。</p>
<p>例如：<code>maven-compiler-plugin</code> 插件就提供了一个 <code>maven.test.skip</code>的系统属性，通过配置是否跳过测试。以下是该插件 <code>testCompile</code>目标的 skip 参数详细信息。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell">skip<br>     User property: maven.test.skip<br>     Set this to &#x27;true&#x27; to bypass compilation of test sources. Its use is NOT<br>     RECOMMENDED, but quite convenient on occasion.<br><br></code></pre></td></tr></table></figure>
<p>可以看到该参数可以使用 <code>maven.test.skip</code>，因此可以编写命令 <code>maven install -Dmaven.test.skip=true</code> 用来跳过测试。</p>
<h3 id="POM-插件配置"><a href="#POM-插件配置" class="headerlink" title="POM 插件配置"></a>POM 插件配置</h3><p>对于一些固定常用的参数，可以直接在 pom 文件中配置，使用 <code>configuration</code> 配置 参数，如下：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs xml"> <span class="hljs-tag">&lt;<span class="hljs-name">plugin</span>&gt;</span><br>             <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>             <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>maven-war-plugin<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>             <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.3.1<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>             <span class="hljs-tag">&lt;<span class="hljs-name">configuration</span>&gt;</span><br>                 <span class="hljs-tag">&lt;<span class="hljs-name">warSourceExcludes</span>&gt;</span>WEB-INF/classes<span class="hljs-tag">&lt;/<span class="hljs-name">warSourceExcludes</span>&gt;</span><br>             <span class="hljs-tag">&lt;/<span class="hljs-name">configuration</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">plugin</span>&gt;</span><br></code></pre></td></tr></table></figure>
<p>如果需要插件在不同声明周期执行相同的目标，但是执行的参数不一样，就需要另外配置。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs xml"> <span class="hljs-tag">&lt;<span class="hljs-name">plugins</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">plugin</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>maven-compiler-plugin<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.1<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>               	 <span class="hljs-tag">&lt;<span class="hljs-name">executions</span>&gt;</span><br>                    <span class="hljs-tag">&lt;<span class="hljs-name">execution</span>&gt;</span><br>                        <span class="hljs-tag">&lt;<span class="hljs-name">id</span>&gt;</span>diy-compile<span class="hljs-tag">&lt;/<span class="hljs-name">id</span>&gt;</span><br>                        <span class="hljs-tag">&lt;<span class="hljs-name">phase</span>&gt;</span>install<span class="hljs-tag">&lt;/<span class="hljs-name">phase</span>&gt;</span><br>                        <span class="hljs-tag">&lt;<span class="hljs-name">goals</span>&gt;</span><br>                            <span class="hljs-tag">&lt;<span class="hljs-name">goal</span>&gt;</span>testCompile<span class="hljs-tag">&lt;/<span class="hljs-name">goal</span>&gt;</span><br>                        <span class="hljs-tag">&lt;/<span class="hljs-name">goals</span>&gt;</span><br>                        <span class="hljs-tag">&lt;<span class="hljs-name">configuration</span>&gt;</span><br>                  					...<br>                			  <span class="hljs-tag">&lt;/<span class="hljs-name">configuration</span>&gt;</span><br>                    <span class="hljs-tag">&lt;/<span class="hljs-name">execution</span>&gt;</span><br>                   <br>                      <span class="hljs-tag">&lt;<span class="hljs-name">execution</span>&gt;</span><br>                        <span class="hljs-tag">&lt;<span class="hljs-name">id</span>&gt;</span>diy-test<span class="hljs-tag">&lt;/<span class="hljs-name">id</span>&gt;</span><br>                        <span class="hljs-tag">&lt;<span class="hljs-name">phase</span>&gt;</span>verify<span class="hljs-tag">&lt;/<span class="hljs-name">phase</span>&gt;</span><br>                        <span class="hljs-tag">&lt;<span class="hljs-name">goals</span>&gt;</span><br>                            <span class="hljs-tag">&lt;<span class="hljs-name">goal</span>&gt;</span>testCompile<span class="hljs-tag">&lt;/<span class="hljs-name">goal</span>&gt;</span><br>                        <span class="hljs-tag">&lt;/<span class="hljs-name">goals</span>&gt;</span><br>                        <span class="hljs-tag">&lt;<span class="hljs-name">configuration</span>&gt;</span><br>                  					...<br>                			  <span class="hljs-tag">&lt;/<span class="hljs-name">configuration</span>&gt;</span><br>                    <span class="hljs-tag">&lt;/<span class="hljs-name">execution</span>&gt;</span><br>                <span class="hljs-tag">&lt;/<span class="hljs-name">executions</span>&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">plugin</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">plugins</span>&gt;</span><br></code></pre></td></tr></table></figure>
<p>如上同一插件的同一目标绑定了不同的声明周期阶段，具体的参数配置只需要在各自的 <code>configuration</code> 配置即可。</p>
<h2 id="聚合与继承"><a href="#聚合与继承" class="headerlink" title="聚合与继承"></a>聚合与继承</h2><h3 id="聚合"><a href="#聚合" class="headerlink" title="聚合"></a>聚合</h3><p>为了方便使用命令管理多个模块，就需要用到<strong>聚合。</strong>例如：项目中有 A，B 两个模块，需要对两个项目都执行清理 操作，因此你需要跑到 A 模块下执行 <code>mvn clean</code>命令，然后再跑到 B 模块下执行相同的命令。模块较多的话就比较麻烦。</p>
<p>使用聚合就可以解决上述问题。新建一个聚合模块，然后将聚合模块的打包方式修改成 pom，并使用标签 <code>modules</code>引入模块 A，B，然后对聚合模块操作即可。示例代码：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">packaging</span>&gt;</span>pom<span class="hljs-tag">&lt;/<span class="hljs-name">packaging</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">modules</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">module</span>&gt;</span>A模块目录名称<span class="hljs-tag">&lt;/<span class="hljs-name">module</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">module</span>&gt;</span>B模块目录名称<span class="hljs-tag">&lt;/<span class="hljs-name">module</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">modules</span>&gt;</span><br></code></pre></td></tr></table></figure>
<p>聚合模块可以与其他模块同级，同级只需要将 module 改为 <code>&lt;module&gt;../A模块目录名称&lt;/module&gt;</code> ，特别注意的是聚合模块的打包方式一定要修改成pom。</p>
<h3 id="继承"><a href="#继承" class="headerlink" title="继承"></a>继承</h3><p>继承的出现是为了消除重复，Java 如此，Maven 中的 pom 也是如此。假如有 A，B两个模块都需要 <code>spring-core</code> 2.0 版本的依赖，正常的做法就是在两个模块中分别声明同一个 <code>spring-core</code> 依赖。</p>
<p>使用继承消除重复配置，新建一个模块 <code>C</code>，修改打包方式为 pom (与聚合操作一致)，接着引入 <code>spring-core</code>依赖，即可。这时 A，B 模块只需要继承 C 的 pom 即可，代码如下。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">parent</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>C 模块groupId<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>C 模块artifactId<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>C 模块version<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">relativePath</span>&gt;</span>C 模块pom.xml路径（相对路径）<span class="hljs-tag">&lt;/<span class="hljs-name">relativePath</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">parent</span>&gt;</span><br></code></pre></td></tr></table></figure>
<p>引入 C 模块的坐标信息，并使用 <code>relativePath</code> 指向 C 模块的 pom 文件路径。Maven 会首先根据 <code>relativePath</code> 找 pom，找不到就去本地仓库找，如果不配置 realtivePath，那默认值是 <code>../pom.xml</code>，也就是说 Maven 默认父 模块在当前模块的上一层目录。</p>
<p>在上面的例子中 A，B 模块可以不用声明 gruopId 和 version，这些信息都从 C 模块中继承过来了，如果子模块要使用自己的 groupId 和 version 直接显示的声明即可。</p>
<h4 id="Maven-可继承的-POM-元素"><a href="#Maven-可继承的-POM-元素" class="headerlink" title="Maven 可继承的 POM 元素"></a>Maven 可继承的 POM 元素</h4><ul>
<li>groupId 项目组 ID ，项目坐标的核心元素。</li>
<li>version 项目版本，项目坐标的核心元素。</li>
<li>description 项目的描述信息。</li>
<li>organization 项目的组织信息。</li>
<li>inceptionYear 项目的创始年份。</li>
<li>url 项目的 url 地址。</li>
<li>develoers 项目的开发者信息。</li>
<li>contributors 项目的贡献者信息。</li>
<li>distributionManagerment 项目的部署信息。</li>
<li>issueManagement 缺陷跟踪系统信息。</li>
<li>ciManagement 项目的持续继承信息。</li>
<li>scm 项目的版本控制信息。</li>
<li>mailingListserv 项目的邮件列表信息。</li>
<li>properties 自定义的 Maven 属性。</li>
<li>dependencies 项目的依赖配置。</li>
<li>dependencyManagement 醒目的依赖管理配置。</li>
<li>repositories 项目的仓库配置。</li>
<li>build 包括项目的源码目录配置、输出目录配置、插件配置、插件管理配置等。</li>
<li>reporting 包括项目的报告输出目录配置、报告插件配置等。</li>
</ul>
<h4 id="依赖管理"><a href="#依赖管理" class="headerlink" title="依赖管理"></a>依赖管理</h4><p>上面说到依赖可以继承，但是并不是每一个模块都需要引入父模块的依赖。例如一个工具模块，就不太需要 <code>spring</code>这些依赖包，但是因为继承关系，导致工具模块也引入了这些包，为了避免这种情况就需要使用新的元素 dependencyManagement。</p>
<p>dependencyManagement 可以让子类自行的选择继承父模块的依赖，只需要将父模块的依赖用元素 <code>dependencyManagement</code>包裹起来即可。例如父模块依赖代码如下：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependencyManagement</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span><br>    <br>    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-core<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.5.6<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>    <br>     <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>junit<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>junit<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>5.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>test<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>    <br>  <span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependencyManagement</span>&gt;</span><br></code></pre></td></tr></table></figure>
<p>子模块引用父模块依赖，代码如下：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>     <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>junit<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>     <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>junit<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>  <br> <span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span><br></code></pre></td></tr></table></figure>
<p>子模块 pom 直接引用所需要的依赖坐标即可，上面代码只引用了父模块的 junit 依赖，因此 spring-core 不会被引入。子模块还去掉了依赖的 version 和 scope 信息，这是因为继承了父模块的 pom，完整的依赖声明已经在父 pom 中了，因此子模块只需要 groupId 和 artifactId 就能获取对应的依赖信息，这样使用也能使所有子模块统一依赖版本，降低依赖冲突概率。</p>
<p><strong>import 和 dependencyManagement</strong></p>
<p>上面的章节说到过依赖范围 <code>import</code>，import 需要配合 dependencyManagement 使用。作用是将目标模块的 pom 中的 dependencyManagement 配置，导入并合并到当前模块的 pom 的 dependencyManagement 配置中。</p>
<p>例如想要在另一个模块中使用父模块完全一样的 dependencyManagement 配置，需要在 pom 编写如下代码：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependencyManagement</span>&gt;</span><br>  <br>  <span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span><br>  	<span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>父模块 groupId<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>父模块 artifactId<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>父模块 version<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">type</span>&gt;</span>pom<span class="hljs-tag">&lt;/<span class="hljs-name">type</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>import<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependencyManagement</span>&gt;</span><br></code></pre></td></tr></table></figure>

<h4 id="插件管理"><a href="#插件管理" class="headerlink" title="插件管理"></a>插件管理</h4><p>插件管理的思想和依赖管理一致。在父 pom 中使用 <code>pluginManagement</code> 包裹插件，即可达到与依赖管理一样的效果。</p>
<p>子模块使用插件只需要声明 <code>groupid</code> 和 <code>artifactId</code>即可。若子模块需要修改插件的配置信息，只需要在模块中覆盖父类的配置即可。</p>
<h3 id="继承和聚合关系"><a href="#继承和聚合关系" class="headerlink" title="继承和聚合关系"></a>继承和聚合关系</h3><p>都要将打包方式改为 pom，一个模块可以既是聚合模块，又是父模块。</p>
<h2 id="约定优于配置"><a href="#约定优于配置" class="headerlink" title="约定优于配置"></a>约定优于配置</h2><p>我们都知道 Maven 项目的源代码文件夹是 src&#x2F;main&#x2F;java，编译输出文件夹是 target&#x2F;classes&#x2F;，这是 maven 的约定，我们只需要准守即可。当然想要自己改变这些约定也可以做到，但是不推荐。我们准守的这些约定实际上是 maven 的超级 pom 帮我们配置了这些信息。</p>
<p>所有的 maven 项目都隐式地继承了超级 pom，这个超级 pom 配置了源代码目录路径，编译输出路径，测试代码路径等等，这些配置信息就是我们要准守的约定。超级 pom 可以到 maven 的安装目录下 <code>/lib/maven-model-builder-x.x.x.jar</code>文件（x.x.x 代表的是 maven 版本 ），解压之后找到 <code>org/apache/maven/pom-4.0.0.xml</code> 文件即可查看配置信息。这是我本机的超级 pom 的部分配置信息</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">build</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">directory</span>&gt;</span>$&#123;project.basedir&#125;/target<span class="hljs-tag">&lt;/<span class="hljs-name">directory</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">outputDirectory</span>&gt;</span>$&#123;project.build.directory&#125;/classes<span class="hljs-tag">&lt;/<span class="hljs-name">outputDirectory</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">finalName</span>&gt;</span>$&#123;project.artifactId&#125;-$&#123;project.version&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">finalName</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">testOutputDirectory</span>&gt;</span>$&#123;project.build.directory&#125;/test-classes<span class="hljs-tag">&lt;/<span class="hljs-name">testOutputDirectory</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">sourceDirectory</span>&gt;</span>$&#123;project.basedir&#125;/src/main/java<span class="hljs-tag">&lt;/<span class="hljs-name">sourceDirectory</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">scriptSourceDirectory</span>&gt;</span>$&#123;project.basedir&#125;/src/main/scripts<span class="hljs-tag">&lt;/<span class="hljs-name">scriptSourceDirectory</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">testSourceDirectory</span>&gt;</span>$&#123;project.basedir&#125;/src/test/java<span class="hljs-tag">&lt;/<span class="hljs-name">testSourceDirectory</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">resources</span>&gt;</span><br>     <span class="hljs-tag">&lt;<span class="hljs-name">resource</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">directory</span>&gt;</span>$&#123;project.basedir&#125;/src/main/resources<span class="hljs-tag">&lt;/<span class="hljs-name">directory</span>&gt;</span><br>     <span class="hljs-tag">&lt;/<span class="hljs-name">resource</span>&gt;</span><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">resources</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">testResources</span>&gt;</span><br>     <span class="hljs-tag">&lt;<span class="hljs-name">testResource</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">directory</span>&gt;</span>$&#123;project.basedir&#125;/src/test/resources<span class="hljs-tag">&lt;/<span class="hljs-name">directory</span>&gt;</span><br>     <span class="hljs-tag">&lt;/<span class="hljs-name">testResource</span>&gt;</span><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">testResources</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">pluginManagement</span>&gt;</span><br>     <span class="hljs-comment">&lt;!-- <span class="hljs-doctag">NOTE:</span> These plugins will be removed from future versions of the super POM --&gt;</span><br>     <span class="hljs-comment">&lt;!-- They are kept for the moment as they are very unlikely to conflict with lifecycle mappings (MNG-4453) --&gt;</span><br>     <span class="hljs-tag">&lt;<span class="hljs-name">plugins</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">plugin</span>&gt;</span><br>         <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>maven-antrun-plugin<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>         <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.3<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>       <span class="hljs-tag">&lt;/<span class="hljs-name">plugin</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">plugin</span>&gt;</span><br>         <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>maven-assembly-plugin<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>         <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.2-beta-5<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>       <span class="hljs-tag">&lt;/<span class="hljs-name">plugin</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">plugin</span>&gt;</span><br>         <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>maven-dependency-plugin<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>         <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.8<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>       <span class="hljs-tag">&lt;/<span class="hljs-name">plugin</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">plugin</span>&gt;</span><br>         <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>maven-release-plugin<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>         <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.5.3<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>       <span class="hljs-tag">&lt;/<span class="hljs-name">plugin</span>&gt;</span><br>     <span class="hljs-tag">&lt;/<span class="hljs-name">plugins</span>&gt;</span><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">pluginManagement</span>&gt;</span><br> <span class="hljs-tag">&lt;/<span class="hljs-name">build</span>&gt;</span><br></code></pre></td></tr></table></figure>

<h2 id="反应堆"><a href="#反应堆" class="headerlink" title="反应堆"></a>反应堆</h2><p>之前使用到聚合的知识，用一个聚合模块包含多个模块，只要对聚合模块操作即可影响到包含的模块。我们把包含的这一堆模块叫做<strong>反应堆。</strong>为啥叫反应堆呢，因为需要发生反应，在构建这些模块的时候肯定存在一个构建顺序，依次构建。</p>
<p>例如聚合模块 A，按顺序包含模块 B，C，D。按照正常理解，对 A 模块进行构建时，我们会认为，B，C，D 会按照顺序依次构建，但实际的构建顺序却不一定是我们预期的那样。</p>
<p>实际的构建顺序是这样的：<strong>Maven 先按照顺序读取 pom，如果 pom 没有依赖模块，那么就构建该模块，否则就构建其依赖模块，若依赖模块还依赖其他模块，则进一步构建依赖模块。</strong></p>
<p>在实际开发中可以使用一些参数，来决定需要构建的模块，或者指定模块构建的顺序。假设模块 A，模块 B 都依赖于模块 C。</p>
<ul>
<li>-am， 同时构建所列模块的依赖模块。例如：<code>mvn clean install -pl A -am</code>，结果顺序：C ，A。</li>
<li>-amd 同时构建依赖于所列模块的模块。例如：<code>mvn clean install -pl C -amd</code>，结果顺序：C，A，B</li>
<li>-pl 构建指定的模块，模块间用逗号分隔。例如：<code>mvn clean install -pl A，B</code></li>
<li>-rf  在完整的构建顺序基础上指定从哪个模块开始构建。例如：<code>mvn clean install -pl C -amd -rf B</code> 结果顺序：C，B，A</li>
</ul>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" class="category-chain-item">学习笔记</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/Maven/">#Maven</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>《Maven 实战》笔记</div>
      <div>http://wszzf.top/2021/08/20/《Maven 实战》/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>Greek</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2021年8月20日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2021/08/26/Maven%20%E4%BE%9D%E8%B5%96%E4%B8%8E%E6%8F%92%E4%BB%B6%E8%A7%A3%E6%9E%90%E6%9C%BA%E5%88%B6/" title="Maven 依赖与插件解析机制">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">Maven 依赖与插件解析机制</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2021/08/18/Collection%20%E4%B8%8D%E5%B8%B8%E8%A7%81%E7%9A%84%E9%87%8D%E8%A6%81%E5%AE%9E%E7%8E%B0%E5%92%8C%E5%8E%9F%E7%90%86/" title="Collection 笔记">
                        <span class="hidden-mobile">Collection 笔记</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>





  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
